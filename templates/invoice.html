<!-- templates/invoice.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Invoice Generator | A.R. Engineering</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-light">
  <div class="container mt-4">
    <h2 class="text-center mb-4">A.R. ENGINEERING</h2>
    <p class="text-center text-muted">WE UNDERTAKE ALL TYPES OF ENGINEERING WORKS</p>

    <form method="POST" action="/create_invoice">
      <div class="row">
        <div class="col-md-6">
          <label>Customer Name</label>
          <input class="form-control" name="customer_name" required>
        </div>
        <div class="col-md-3">
          <label>Invoice No.</label>
          <input class="form-control" name="gst_invoice_no" required>
        </div>
        <div class="col-md-3">
          <label>Date</label>
          <input class="form-control" type="date" name="date" required>
        </div>
      </div>

      <hr>
      <h5>Items</h5>
      <table class="table table-bordered" id="items-table">
        <thead>
          <tr>
            <th>Description</th>
            <th>HSN</th>
            <th>Qty</th>
            <th>Rate</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input class="form-control" name="description[]" required></td>
            <td><input class="form-control" name="hsn_code[]"></td>
            <td><input type="number" class="form-control qty" name="quantity[]" value="1"></td>
            <td><input type="number" class="form-control rate" name="rate[]" value="0"></td>
            <td class="amount">0</td>
          </tr>
        </tbody>
      </table>
      <button type="button" class="btn btn-outline-primary" id="add-row">+ Add Item</button>

      <div class="text-end mt-3">
        <h5>Total: â‚¹ <span id="total">0</span></h5>
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="btn btn-success">Generate Invoice (PDF)</button>
      </div>
    </form>
  </div>

<script>
$("#add-row").click(() => {
  $("#items-table tbody").append(`
    <tr>
      <td><input class="form-control" name="description[]" required></td>
      <td><input class="form-control" name="hsn_code[]"></td>
      <td><input type="number" class="form-control qty" name="quantity[]" value="1"></td>
      <td><input type="number" class="form-control rate" name="rate[]" value="0"></td>
      <td class="amount">0</td>
    </tr>`);
});

$(document).on("input", ".qty, .rate", function() {
  let total = 0;
  $("#items-table tbody tr").each(function() {
    let qty = parseFloat($(this).find(".qty").val()) || 0;
    let rate = parseFloat($(this).find(".rate").val()) || 0;
    let amt = qty * rate;
    $(this).find(".amount").text(amt.toFixed(2));
    total += amt;
  });
  $("#total").text(total.toFixed(2));
});
</script>
</body>
</html>
